<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChefZZZ | Modern Recipe Diary</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #fdfbfb;
            --lavender: #f3e8ff;
            --mint: #ecfdf5;
            --peach: #fff1f2;
            --accent: #a78bfa;
            --text: #4b5563;
        }

        body { 
            font-family: 'Quicksand', sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            margin: 0; 
        }

        /* --- Login Overlay --- */
        #login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, var(--lavender), var(--peach));
            z-index: 2000; display: flex; justify-content: center; align-items: center;
        }
        .login-card {
            background: white; padding: 50px; border-radius: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.05); text-align: center;
        }

        /* --- Navigation --- */
        nav { 
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 40px; background: rgba(255,255,255,0.7);
            backdrop-filter: blur(15px); position: sticky; top: 0; z-index: 100;
        }
        .nav-links button {
            background: none; border: none; font-size: 1rem; font-weight: 700;
            cursor: pointer; color: #9ca3af; margin-left: 20px; transition: 0.3s;
        }
        .nav-links button.active { color: var(--accent); }

        /* --- Hero Section --- */
        header { 
            text-align: center; padding: 80px 20px;
            background: linear-gradient(to bottom, var(--peach), var(--bg));
        }
        .search-box { display: flex; justify-content: center; gap: 10px; margin-top: 30px; flex-wrap: wrap; }
        
        input { 
            padding: 15px 25px; border-radius: 30px; border: 2px solid white;
            width: 320px; outline: none; box-shadow: 0 10px 20px rgba(0,0,0,0.02);
            font-family: inherit;
        }

        .btn {
            padding: 12px 25px; border-radius: 30px; border: none;
            cursor: pointer; font-weight: 700; transition: 0.3s;
        }
        .btn-main { background: var(--accent); color: white; }
        .btn-alt { background: var(--mint); color: #065f46; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }

        /* --- Grid & Cards --- */
        .grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px; padding: 40px; max-width: 1200px; margin: auto;
        }
        .card {
            background: white; border-radius: 35px; overflow: hidden;
            transition: 0.4s; border: 1px solid #f3f4f6; cursor: pointer;
        }
        .card:hover { transform: translateY(-10px); box-shadow: 0 25px 50px rgba(0,0,0,0.08); }
        .card img { width: 100%; height: 220px; object-fit: cover; }
        .card-info { padding: 20px; text-align: center; }

        /* --- Modal --- */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.3); backdrop-filter: blur(10px); z-index: 1000;
        }
        .modal-content {
            background: white; width: 95%; max-width: 700px; margin: 30px auto;
            border-radius: 40px; overflow: hidden; position: relative;
            max-height: 90vh; overflow-y: auto;
        }
        .modal-padding { padding: 30px; }
        .yt-btn {
            display: inline-block; background: #fee2e2; color: #b91c1c;
            padding: 10px 20px; border-radius: 15px; text-decoration: none;
            font-weight: 700; margin-top: 20px;
        }

        /* --- History Section --- */
        #history-section { display: none; padding: 40px; max-width: 800px; margin: auto; }
        .history-card {
            background: white; padding: 20px; border-radius: 20px;
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 15px; border-left: 8px solid var(--mint);
        }
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="login-card">
        <h2 style="color: var(--accent);">chefZ Diary ðŸŽ¨</h2>
        <p>Save your cooking history and discover flavors.</p>
        <input type="text" id="user-name" placeholder="Enter your name">
        <button class="btn btn-main" style="margin-top: 20px;" onclick="doLogin()">Start Cooking</button>
    </div>
</div>

<nav>
    <div style="font-size: 1.5rem; font-weight: 700; color: var(--accent);">AuraKitchen.</div>
    <div class="nav-links">
        <button id="btn-discover" class="active" onclick="showTab('discover')">Explore</button>
        <button id="btn-history" onclick="showTab('history')">My History</button>
        <span id="display-name" style="margin-left: 20px; font-weight: 500; color: #9ca3af;"></span>
    </div>
</nav>

<div id="discover-view">
    <header>
        <h1 id="greeting">Welcome!</h1>
        <div class="search-box">
            <input type="text" id="search-input" placeholder="Search ingredient (e.g. Honey)">
            <button class="btn btn-main" onclick="fetchMeals('search')">Search</button>
            <button class="btn btn-alt" onclick="fetchMeals('random')">Surprise Me âœ¨</button>
        </div>
    </header>
    <div id="meal-grid" class="grid"></div>
</div>

<div id="history-section">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h1>Your Cooking Diary</h1>
        <button onclick="clearHistory()" style="background: none; border: none; color: #ef4444; cursor: pointer;">Clear All</button>
    </div>
    <div id="history-list"></div>
</div>

<div id="recipe-modal" class="modal" onclick="closeModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div id="modal-inner"></div>
    </div>
</div>

<script>
    let user = "";
    let history = JSON.parse(localStorage.getItem('myRecipes')) || [];

    function doLogin() {
        const name = document.getElementById('user-name').value;
        if(!name) return;
        user = name;
        document.getElementById('login-overlay').style.display = 'none';
        document.getElementById('display-name').innerText = `Hi, ${name}`;
        document.getElementById('greeting').innerText = `What's on the menu, ${name}?`;
        renderHistory();
    }

    function showTab(tab) {
        document.getElementById('discover-view').style.display = tab === 'discover' ? 'block' : 'none';
        document.getElementById('history-section').style.display = tab === 'history' ? 'block' : 'none';
        document.getElementById('btn-discover').classList.toggle('active', tab === 'discover');
        document.getElementById('btn-history').classList.toggle('active', tab === 'history');
    }

    async function fetchMeals(type) {
        let url = `https://www.themealdb.com/api/json/v1/1/random.php`;
        if(type === 'search') {
            const q = document.getElementById('search-input').value;
            if(!q) return;
            url = `https://www.themealdb.com/api/json/v1/1/search.php?s=${q}`;
        }

        const grid = document.getElementById('meal-grid');
        grid.innerHTML = "Searching...";

        const res = await fetch(url);
        const data = await res.json();
        grid.innerHTML = "";

        if(data.meals) {
            data.meals.forEach(m => {
                grid.innerHTML += `
                    <div class="card" onclick="openDetails('${m.idMeal}')">
                        <img src="${m.strMealThumb}">
                        <div class="card-info">
                            <h3>${m.strMeal}</h3>
                            <span style="color:var(--accent); font-size:0.8rem;">${m.strCategory}</span>
                        </div>
                    </div>`;
            });
        } else {
            grid.innerHTML = "No recipes found. Try another word!";
        }
    }

    async function openDetails(id) {
        const res = await fetch(`https://www.themealdb.com/api/json/v1/1/lookup.php?i=${id}`);
        const data = await res.json();
        const m = data.meals[0];

        let ingredients = "";
        for(let i=1; i<=20; i++) {
            if(m[`strIngredient${i}`]) {
                ingredients += `<li>${m[`strIngredient${i}`]} - ${m[`strMeasure${i}`]}</li>`;
                //ingredients += `<li>${m[`strIngredient${i}`]} - ${m[`strMeasure${i}`]}</li>`;
            }
        }

        document.getElementById('modal-inner').innerHTML = `
            <img src="${m.strMealThumb}" style="width:100%; height:300px; object-fit:cover;">
            <div class="modal-padding">
                <h2>${m.strMeal}</h2>
                <button class="btn btn-alt" onclick="saveToHistory('${m.strMeal}')">âœ… Log as Cooked</button>
                <div style="margin-top:20px;">
                    <h4>Ingredients</h4>
                    <ul>${ingredients}</ul>
                    <h4>Steps</h4>
                    <p style="white-space: pre-line; font-size: 0.9rem;">${m.strInstructions}</p>
                </div>
                ${m.strYoutube ? `<a href="${m.strYoutube}" target="_blank" class="yt-btn">ðŸ“º Watch Video Tutorial</a>` : ''}
            </div>
        `;
        document.getElementById('recipe-modal').style.display = 'block';
    }

    function saveToHistory(name) {
        const entry = { name, date: new Date().toLocaleDateString() };
        history.unshift(entry);
        localStorage.setItem('myRecipes', JSON.stringify(history));
        renderHistory();
        alert("Saved to your cooking diary!");
        closeModal();
    }

    function renderHistory() {
        const list = document.getElementById('history-list');
        list.innerHTML = history.length ? history.map(h => `
            <div class="history-card">
                <strong>${h.name}</strong>
                <span style="font-size:0.8rem; color:#94a3b8;">${h.date}</span>
            </div>
        `).join('') : "<p>Your diary is empty.</p>";
    }

    function clearHistory() {
        if(confirm("Clear your entire diary?")) {
            history = [];
            localStorage.removeItem('myRecipes');
            renderHistory();
        }
    }

    function closeModal() { document.getElementById('recipe-modal').style.display = 'none'; }
</script>

</body>
</html>
